# Инструкция по расшифровке #

[TOC]
## Подача материала ##

 Содержимое сайта находится в GitHub <a href="https://github.com/opentorah/alter-rebbe.org">
      <svg class="svg-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/assets/icons.svg#github"></use></svg>
      <span class="username">repository</span>
    </a> <a href="https://github.com/opentorah/alter-rebbe.org/actions">
  <img src="https://github.com/opentorah/alter-rebbe.org/workflows/CI/badge.svg" alt="CI badge"/>
</a>.

Рекомендуемый способ участия в расшифровке, исправлении ошибок и т.д. - открыть GitHub pull request.
Прошёл ли Ваш pull request все проверки можно посмотреть в нём самом или на
[странице непрерывной интеграции](https://github.com/opentorah/alter-rebbe.org/actions). 

Если прогресс (пока) не пришёл в Ваш дом, и термины GitHub, repository и pull request Вам ничего не
говорят - можно воспользоваться электронной почтой по адресу [dub@opentorah.org](mailto:dub@opentorah.org).

## Формат ##

Файлы с расшифровами документов находятся в директориях `/archive/`;
они названы по номеру первой страницы документа, например: `001.xml`, `088a.xml`.

Файлы с информацией об именах упомянутых в документах находятся в директории `/names`.

Все они хранятся в XMLе, в формате [TEI](https://www.tei-c.org/release/doc/tei-p5-doc/en/html/)
("Text Encoding Initiative", "Инициатива по Кодировке Текстов"), вот уже более 30ти лет
разрабатываемом [содружеством](https://tei-c.org/) учёных-гуманитариев.

Расшифровки документов на этом сайте используют лишь небольшое подмножество TEI;
мы не пользуемся возможностями формата кодировать грамматический анализ текста,
варианты текста, местоположение фрагментов текста на листе, разницу почерков и т.д.

## Верность оригиналу ##

Наша задача - представить оригинальные тексты документов как они есть. В частности:

- если текст использует буквы, которых нет в "современном" русском языке
  (например, `ъ` `ѣ` `і` `ї` `І` `Ј` `ј`), они должны быть переданы в расшифровке, причём -
  правильными символами стандарта [Unicode](https://www.unicode.org/charts/PDF/U0400.pdf)
  (например,`Ј` а не `J`) ;
- если текст использует "архаичные" формы слов
  (например, `оной`), они должны быть переданы в расшифровке;
- если текст использует "архаичные" написания имён
  (например, `Жегулин`, а не `Жигулин`), они должны быть переданы в расшифровке;
     
и т.п.

## Структура ##

Файл в формате TEI содержит в себе [заголовок](#teiheader) (`teiHeader`) и сам текст (`text`);
расшифровка текста находится внутри элемента `body`.

```xml
<TEI xmlns="http://www.tei-c.org/ns/1.0">
  <teiHeader>
  ...
  </teiHeader>
  <text xml:lang="ru">
    <body>
    ...
    </body>
  </text>
</TEI>
```

Во всех файлах уже проставлены начала страниц (`pb`, "page beginning"):
```xml
<pb n="002-1"/>
```
Расшифровка текста страницы должна следовать за её началом :)

## Кодировка ##

Для кодировки заметок не являющихся частью оригинального текста документов (например, номера
документа, номера страницы, позднейших вставок другим почерком, информации о пошлинах и т.д.)
используется элемент `fw`:
```xml
<fw type="docNum">№ 1762.</fw>
```

Для кодировки зачёркнутого текста используется элемент `del`; добавляется атрибут
`rend` со значением `overstrike`. Пример: на правой стороне страницы зачёркнут номер 33 и
проставлен номер 30:
```xml
<fw type="pageNum" place="right"><del rend="overstrike">33</del></fw>
<fw type="pageNum" place="right">30</fw>
```

Заголовок документа (если он есть) кодируется элементом `head`:
```xml
<head>Объяснение О начале и правилах секты Каролинов.</head>
```

Абзац текста кодируется элементом `p`:
```xml
<p>Присланное при всепочтеннейшимъ отношении отъ ... </p>
```

Строчки текста кодируются элементом `l`:
```xml
<l>Его императорское величество высо-</l>
<l>чайше повелеть соизволил, дѣло между</l>
```

В тех (и только в тех!) случаях, когда новая строчка начинается внутри тага, начавшегося на
предыдущей строчке, её начало кодируется тагом `lb`:
```xml
<l>кавалеромъ <persName ref="Обольяниновъ">Петромъ Хрисанфови-<lb/>
   чемъ Обольяниновымъ</persName> въ <date when="1800-11-27">27<hi rend="superscript">й</hi> день<lb/>
   сего ноября</date>, о разсмотренiи Сенату</l>
```

Визуально выделенный текст кодируется элементом `emph` если его выделенность несёт смысловую нагрузку и
элементом `hi` если нет. Каким образом текст выделен кодируется аттрибутом `rend` соответствующего элемента.
Возможные значения этого атрибута: `underline` если текст подчёркнут, `big` если увеличен размер букв,
`superscript` если текст поднят над строкой. Примеры:
```xml
<emph rend="underline">Допросы Евреевъ</emph>
<emph rend="big">вашему императорскому величеству</emph>
Ноября 27<hi rend="superscript">го</hi> дня
``` 

Нерзборчивые места текста кодируются элементом `unclear`:
```xml
отнял у них книги <unclear>Лекуда</unclear>
```

Нестандартное написание и описки присутствующие в оригинальных документах кодируются элементом `sic`:  
```xml
<sic>богаствъ</sic>
```

Правильное написание кодируется элементом `choice` с вложенными в него (в произвольном порядке)
элементами `sic` и `corr`:
```xml
<choice>
  <corr>успѣхѣ онаго</corr>
  <sic>успѣхѣ онаге</sic>
</choice>
```

Замечания расшифровщика вставляются в текст расшифровки в виде элемента `note` с атрибутом `place`
со значение `end`; на сайте эти замечания выглядят как подстрочные:
```xml
<note place="end">Не отдельный ли это документ?</note>
```

Замечания, присутствующие в оригинале (где они, как правило, выделены символами `|:` и `:|`),
кодируются элементом `note` с атрибутом `type` со значением `gloss`; на сайте эти замечания выделяются
визуально:
```xml
<note type="gloss">|: о коем выше :|</note>
```

То, что имеется в виду, может быть добавлено элементом `supplied`:
```xml
<supplied reason="implied">Магид</supplied>
```
в браузере добавленное будет заключено в квадратные скобки: `[Магид]`.

Обращение:
```xml
<salute>Милостивый государь мой Петръ Хрисанфовичь!</salute>
```

Подпись:
```xml
<signed>θедоръ Брискорнъ.</signed>
```

Даты кодитуются элементом `date`, где атрибут `when` даёт дату в стандартной форме (в те годы использовался
юлианский календарь):
```xml
<date when="1798-10-18">18 Октября</date>
```

Дата вместе с местом написания:
```xml
<dateline>В <placeName ref="Петербург">С.-П-Бургѣ</placeName>,
  <date when="1800-04-23">апрѣля 23-го 1800-го</date>.</dateline>
```

Для группирования информации в начале текста (дата, место, исходящий номер и т.д.) может быть использован
элемент `opener`; в конце документа (дата, подпись и т.д.) - `closer`. Чётких правил по пользованию
этими элементами пока не выработалось :( 

Ссылки на веб-страницы кодируются элементом `ref`, где адрес страницы - значение атрибута `target`:
```xml
<ref target="https://ru.wikipedia.org/wiki/Баал-Шем-Тов">[Википедия]</ref>
```

Если в адресе страницы есть символ `&`, то его надо заменить на `&amp;`:
```xml
<ref target="https://forum.j-roots.info/viewtopic.php?t=5970&amp;start=240">j-roots</ref>
```

Текст, нажатием на который происходит переход по ссылке - это содержимое элемента `ref`;
заключать этот текст в квадратные скобки или заменять в нём пробелы на подчёркивания нет
необходимости; единственное требование к этому тексту - он должен присутствовать :)

Ссылка на документ сайта кодируется его относительным адресом (т.е., адрес начинается не с
имени сайта, а с `/`): `<ref targte="/rgada/090">090</ref>`; ссылка на коллекцию сайта
кодируется аналогично: `<ref targte="/rgada">РГАДА</ref>`.

## Имена ##

Имена людей, мест и организаций кодируются элементами `persName`, `placeName` и `orgName`
соответственно; атрибут `ref` отсылает к соответствующему элементу
(`person`, `place`, `org`) в файле в директории `/names`:
```xml
<persName ref="alter-rebbe">Алтер Ребе</persName>
в <placeName ref="Вильна">Вильне</placeName>
<orgName ref="Виленский_кагал">виленский кагал</orgName>
```

Файл про организацию выглядит таким образом:
```xml
<org>
  <orgName>Губернатор</orgName>
</org>
```
про местность - таким:
```xml
<place>
  <placeName>Литва</placeName>
</place>
```
а про человека - вот так:
```xml
<person>
  <persName>Баал Шем Тов</persName>
  <ref target="https://ru.wikipedia.org/wiki/Баал-Шем-Тов">[Википедия]</ref>
</person>
``` 
Имена этих файлов - это те идентификаторы, которые используются для ссылок: `ref="Баал_Шем_Тов"`.
Атрибут `ref` может отсутствовать.

Код который порождает сайт:
- если у ссылки на имя присутствует атрибут `ref`, проверяет, что в имя, на которое этот атрибут ссылается, наличествует;
- вставляет в файл с именами обратные ссылки на документы где каждое из имён присутствует;
- перечисляет (в файле `/report/no-refs.html`) имена, закодированные без атрибута `ref`.

## teiHeader ##

Элемент `teiHeader` содержит метаинформацию о документе, которая показывается в (порождаемом программой) оглавлении
коллекции:
- автор (`author`);
- расшифровщик (`editor`; атрибут `role` со значением `transcriber`);
- краткое содержание (`abstract`);
- дата написания (`date` внутри элемента `creation`);
- имя человека, которому документ адресован (внутри элемента `profileDesc` элементом `correspDesc`,
  содержащим элемент `persName` с атрибутом `ref` со значением `addressee`): 

```xml
<teiHeader>
  <fileDesc>
    <titleStmt>
      <author><persName ref="Гирш_Давидовичъ">Гирш Давидович</persName></author>
      <editor role="transcriber"><persName ref="VK">Василий Когаловский</persName></editor>
    </titleStmt>
  </fileDesc>
  <profileDesc>
    <abstract><p>Донос</p></abstract>
    <creation><date when="1800-04-23">1800-04-23</date></creation>
    <correspDesc>
      <correspAction><persName ref="Обольянинов" role="addressee">Обольянинову</persName></correspAction>
    </correspDesc>
  </profileDesc>
</teiHeader>
```

## Ресурсы ##

Порождаются списки <a href="/report/index.html" target="collectionViewer">шероховатостей</a> в кодировке.

Можно посмотреть различные <a href="/note/index.html" target="collectionViewer">заметки</a>.

Исходные документы из репозитории GitHub обрабатываются и публикуются на сайте `store.alter-rebbe.org`.
HTML для показа в браузерах порождается динамически сайтом `www.alter=rebbe.org`.

Факсимиле документов опубликованы на сайте `facsimiles.alter-rebbe.org`. Туда ведут ссылки из страниц сайта `www.alter-rebbe.org`.
Этот сайт на самом деле - Google Storage [Bucket](https://console.cloud.google.com/storage/browser/facsimiles.alter-rebbe.org).
Имея доступ, можно посмотреть, что там есть.

Факсимиле как они были получены из архивов (листы не разрезаны, файлы не переименованы)
и прочая информация хранятся в [Google Drive](https://drive.google.com/drive/folders/1AiYcBGocnO4D6pgSPn475EkWqb4mub9T?usp=sharing).
Имея доступ, можно посмотреть, что там есть.

<script type="module">
  window.name = "collectionViewer"
</script>
